<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bilateral / anisotropic filtering of gradient field — smooth_field_edges_cpp • tessera</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bilateral / anisotropic filtering of gradient field — smooth_field_edges_cpp"><meta name="description" content="Gradient fields are smoothed using bilateral filtering,
in which the smoothed gradient of each edge is computed as
the weighted average of the neighboring edges' gradients, considering
both distance in space and also similarity in gradients."><meta property="og:description" content="Gradient fields are smoothed using bilateral filtering,
in which the smoothed gradient of each edge is computed as
the weighted average of the neighboring edges' gradients, considering
both distance in space and also similarity in gradients."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tessera</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette_basic.html">Quickstart: Using Tessera on a Single Sample</a></li>
    <li><a class="dropdown-item" href="../articles/vignette_stepthrough.html">Walkthrough: Tessera Algorithm Step-by-Step</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/korsunskylab/tessera/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Bilateral / anisotropic filtering of gradient field</h1>
      <small class="dont-index">Source: <a href="https://github.com/korsunskylab/tessera/blob/main/R/RcppExports.R" class="external-link"><code>R/RcppExports.R</code></a></small>
      <div class="d-none name"><code>smooth_field_edges_cpp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Gradient fields are smoothed using bilateral filtering,
in which the smoothed gradient of each edge is computed as
the weighted average of the neighboring edges' gradients, considering
both distance in space and also similarity in gradients.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">smooth_field_edges_cpp</span><span class="op">(</span></span>
<span>  <span class="va">from_pt</span>,</span>
<span>  <span class="va">to_pt</span>,</span>
<span>  <span class="va">field</span>,</span>
<span>  <span class="va">edges_svd</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  <span class="va">adj_idx</span>,</span>
<span>  <span class="va">distance</span>,</span>
<span>  <span class="va">similarity</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-from-pt-to-pt">from_pt, to_pt<a class="anchor" aria-label="anchor" href="#arg-from-pt-to-pt"></a></dt>
<dd><p>A pair of <code>E</code>-length vectors indicating
the start and end points of each edge (0-indexed).</p></dd>


<dt id="arg-field">field<a class="anchor" aria-label="anchor" href="#arg-field"></a></dt>
<dd><p>A <code>2</code> x <code>D</code> x <code>E</code> array in column-major ordering
containing the spatial gradient in expression for each of
<code>D</code> latent variables at every edge.</p></dd>


<dt id="arg-edges-svd">edges_svd<a class="anchor" aria-label="anchor" href="#arg-edges-svd"></a></dt>
<dd><p>A list with elements <code>u</code> (<code>2</code> x <code>2</code> x <code>E</code>), <code>s</code> (<code>2</code> x <code>E</code>), and
<code>v</code> (<code>D</code> x <code>2</code> x <code>E</code>) containing the left singular vectors, singular values,
and right singular vectors for each edge.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>A <code>N</code> x <code>2</code> matrix of cell coordinates.</p></dd>


<dt id="arg-adj-idx">adj_idx<a class="anchor" aria-label="anchor" href="#arg-adj-idx"></a></dt>
<dd><p>A <code>N</code> x <code>N</code> sparse adjacency matrix in dgCMatrix format,
containing the mapping from cells to edges. In particular, <code>adj_idx@x</code>
should store the 1-indexed edge indices corresponding to each cell-cell pair.
The adjacency matrix is assumed to be symmetric and have zeros on the diagonal.
Importantly, note that the stored edge indices are 1-indexed (<em>not</em> 0-indexed here)
in order to avoid problems with R's sparse matrix representation.</p></dd>


<dt id="arg-distance">distance<a class="anchor" aria-label="anchor" href="#arg-distance"></a></dt>
<dd><p>Method for computing distance score in weighted average.
See description for details. Defaults to <code>'euclidean'</code>.</p></dd>


<dt id="arg-similarity">similarity<a class="anchor" aria-label="anchor" href="#arg-similarity"></a></dt>
<dd><p>Method for computing similarity score in weighted average.
See description for details. Defaults to <code>'euclidean'</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>2</code> x <code>D</code> x <code>E</code> array in column-major ordering
containing the smoothed spatial gradient in expression for each of
<code>D</code> latent variables at every edge.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ilya Korsunsky, Daniel Stein.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

